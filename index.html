<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r83/three.js"
    ></script>
    <script
      src="./perlin.js"
    ></script>
    <title>ArtKlubProstor</title>
  </head>
  <body>
    <h1>Eeepaaa</h1>
    <canvas id="canvas"></canvas>
  </body>
</html>

<script>
  var renderer = new THREE.WebGLRenderer({
    canvas: document.getElementById("canvas"),
    antialias: true,
  });
  // default bg canvas color //
  renderer.setClearColor(0xffffff);
  //  use device aspect ratio //
  renderer.setPixelRatio(window.devicePixelRatio);
  // set size of canvas within window //
  renderer.setSize(window.innerWidth, window.innerHeight);

  var scene = new THREE.Scene();
  var camera = new THREE.PerspectiveCamera(
    55,
    window.innerWidth / window.innerHeight,
    0.1,
    1000
  );
  camera.position.z = 5;

  var sphere_geometry = new THREE.SphereGeometry(1, 256, 128);
  var material = new THREE.MeshNormalMaterial();

  var sphere = new THREE.Mesh(sphere_geometry, material);
  scene.add(sphere);

  var update = function () {
    // change '0.003' for more aggressive animation
    var time = performance.now() * 0.001;
    //console.log(time)

    //go through vertices here and reposition them

    // change 'k' value for more spikes
    var k = 0.7;
    for (var i = 0; i < sphere.geometry.vertices.length; i++) {
      var p = sphere.geometry.vertices[i];
      p.normalize().multiplyScalar(
        1.6 + 0.5 * noise.perlin3(p.x * k + time, p.y * k, p.z * k)
      );
    }
    sphere.geometry.computeVertexNormals();
    sphere.geometry.normalsNeedUpdate = true;
    sphere.geometry.verticesNeedUpdate = true;
  };

  function animate() {
    //sphere.rotation.x += 0.01;
    //sphere.rotation.y += 0.01;

    update();
    /* render scene and camera */
    renderer.render(scene, camera);
    requestAnimationFrame(animate);
  }

  requestAnimationFrame(animate);
</script>
